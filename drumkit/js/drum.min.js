function playBeat(){if(isPlaying!==false){var e=6e4/curTempo/4;$("#tracker li.pip").removeClass("active");$("#tracker li.pip.col_"+curBeat).addClass("active");var t;$(".soundrow[id^=control] li.pip.active.col_"+curBeat).each(function(e){t=document.getElementById($(this).data("sound_id"));if(!t.paused){t.pause();t.currentTime=0}t.play()});curBeat=(curBeat+1)%16}}function buildHash(){var e="";$(".soundrow[id^=control] li.pip").each(function(t){e+=$(this).is(".active")?"1":"0"});e+="|";e+=$("#temposlider").slider("value");if(location.hash!="#"+e)location.hash=e}function parseHash(){if(location.hash.length>0){var e=location.hash.substring(1).split("|");var t=e[0];$(".soundrow[id^=control] li.pip").each(function(e){if(e>=t.length)return false;if(t.charAt(e)=="1"){$(this).addClass("active")}});if(typeof e[1]!=="undefined"){$("#temposlider").slider("value",parseInt(e[1]));$("#tempovalue").innerHTML=e[1];curTempo=parseInt(e[1])}}}function clearAll(){$(".soundrow[id^=control] li.active").removeClass("active")}var isPlaying=false;var curBeat=0;var curTempo=120;$(document).ready(function(){$("audio").each(function(e){var t=this;var n=$('<ul id="control_'+this.id+'" class="soundrow">');n.append('<li class="header">'+this.title+"</li>");for(j=0;j<16;j++){var r=$('<li class="pip col_'+j+'">'+t.id+"</li>").click(function(){$(this).toggleClass("active");buildHash()}).data("sound_id",t.id);n.append(r)}$("<li>").append(n).appendTo("#lights")});$("#soundstart").click(function(){if(isPlaying===false){curBeat=0;isPlaying=setInterval(playBeat,6e4/curTempo/4);this.innerHTML="Stop"}else{clearInterval(isPlaying);isPlaying=false;$("#tracker li.pip").removeClass("active");$("audio").each(function(){this.pause();this.currentTime=0});this.innerHTML="Start"}});$("#clearall").click(clearAll);$("#reload").click(parseHash);if(location.hash==""){}else{parseHash()}$("#tempovalue").html(curTempo);$("#temposlider").slider({value:curTempo,min:30,max:300,step:1,slide:function(e,t){curTempo=t.value;$("#tempovalue").html(curTempo);if(isPlaying!==false){clearInterval(isPlaying);isPlaying=setInterval(playBeat,6e4/curTempo/4)}},stop:function(e,t){buildHash()}})})